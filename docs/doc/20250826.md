## 2025-08-26 

1. 新老用户数 
2. 力扣第一题 两数相加
create database aa;

use aa;

drop table if exists fact_log;
create table if not exists fact_log(
user_id int,
device_id varchar(255),
login_date varchar(255)
);

INSERT INTO fact_log (user_id, device_id, login_date) VALUES
(1, 'd1', '2025-08-01'),
(1, 'd1', '2025-08-02'),
(1, 'd1', '2025-08-04'),

(2, 'd2', '2025-08-01'),
(2, 'd2', '2025-08-03'),

(3, 'd3', '2025-08-02'),
(3, 'd3', '2025-08-03'),
(3, 'd3', '2025-08-04'),

(4, 'd4', '2025-08-03'),

(5, 'd5', '2025-08-04');

select * from fact_log;


select
login_date,
sum(if(login_date=min_date,1,0)) new_user,
sum(if(login_date!=min_date,1,0)) old_user
from(
select
user_id, min(login_date)as min_date
from fact_log
group by user_id
)a left join (
select
user_id, login_date
from fact_log
group by user_id,login_date
)b on a.user_id=b.user_id
group by login_date;